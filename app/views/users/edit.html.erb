<%= render partial: "shared/app_menu" %>

<% provide(:title, "Edit Profile") %>

<div class="section-inside">

<h1><i class="fa fa-user"></i> Edit Profile</h1>

<p>Tell us a little bit about yourself. It helps our algorithm better understand you when you get around to setting some goals.</p>

<%= form_for @user do |form| %>

	<% if @user.errors.any? %>
		<%= render partial: "shared/error_messages", locals: {errors: @user.errors} %>
	<% end %>

	<h2>Personal</h2>

	<%= label_tag "name", "Name" %>
	<%= text_field_tag "name", @user.preferences["name"], placeholder: "What do you go by?" %>

	<%= label_tag "height_display", "Height" %>
	<%= text_field_tag "height_display", @user.preferences["height_display"], placeholder: "e.g. 5'8\", 175 cm, 5 feet 8 inches, 72 inches, etc." %>

	<div class="radio-list">
		<span class="header">Sex</span>

		<%= radio_button_tag 'sex', 'f', @user.preferences["sex"] == "f" ? true : false, :id => "sex-f" %>
		<%= label_tag "sex-f", "Female" %>

		<%= radio_button_tag 'sex', 'm', @user.preferences["sex"] == "m" ? true : false, :id => "sex-m" %>
		<%= label_tag "sex-m", "Male" %>

		<%= radio_button_tag 'sex', 'na', @user.preferences["sex"].blank? || @user.preferences["sex"] == "na" ? true : false, :id => "sex-na" %>
		<%= label_tag "sex-na", "Other / Prefer Not to Disclose" %>
	</div>

	<%= label_tag "birthday", "Birthday" %>
	<%= text_field_tag "birthday", @user.preferences["birthday"], placeholder: "Anything with a year and a month, e.g., May 1982, 05/01/1977, 1/7/88, etc." %>

	<h2>Health and Targets</h2>

	<p><em>Note:</em> Before we can calculate your basal metabolic rate, we need your
	    height (<%= raw(@user.preferences["height"].blank? ? '<span class="dont-got-it"><i class="fa fa-times" aria-hidden="true"></i><span class="screen-reader-text">which we need</span></span>' : '<span class="got-it"><i class="fa fa-check" aria-hidden="true"></i><span class="screen-reader-text">which we have</span></span>')  %>),
	    age (<%= raw(@user.preferences["birthday"].blank? ? '<span class="dont-got-it"><i class="fa fa-times" aria-hidden="true"></i><span class="screen-reader-text">which we need</span></span>' : '<span class="got-it"><i class="fa fa-check" aria-hidden="true"></i><span class="screen-reader-text">which we have</span></span>') %>),
	    and a recent weigh-in (<%= raw(@user.recent_most_weight.nil? ? '<span class="dont-got-it"><i class="fa fa-times" aria-hidden="true"></i><span class="screen-reader-text">which we need</span></span>' : '<span class="got-it"><i class="fa fa-check" aria-hidden="true"></i><span class="screen-reader-text">which we have</span></span>') %>).
	    It also helps to know your sex and activity level, otherwise, our calculator will under-estimate your BMR.
	</p>

	<% bmr = @user.bmr %>
	<%= bmr.nil? ? "" : raw("<p>Calculated BMR: #{@user.bmr}</p>") %>

	<%= label_tag "activity_level", "Activity Level" %>
	<%= select_tag "activity_level", options_for_select([
	                            ["Sedentary", 1],
	                            ["Lightly Active", 2],
	                            ["Active", 3],
	                            ["Highly Active", 4],
	                            ["Intensely Active", 5],
	                            ],
	               @user.preferences["activity_level"]) %>

	<%= label_tag "target_calories", "Target Calories" %>
	<%= text_field_tag "target_calories", @user.preferences["target_calories"], placeholder: "The calories you want to reach every day" %>

  <h2>Faturday</h2>

  <p>Faturdays are any day you don't feel like tracking. You can enter them manually or</p>

	<h2>Settings</h2>

	<%= label_tag "timezone", "Timezone" %>
	<%= select_tag "timezone",
			options_for_select(
				time_zone_options_for_select(@user.preferences["timezone"], nil, ActiveSupport::TimeZone)
			), prompt: "Detect Automatically"
	%>

	<div class="radio-list">
		<span class="header">Units</span>

		<%= radio_button_tag 'units', 'i', @user.preferences["units"] == "i" ? true : false, :id => "units-i" %>
		<%= label_tag "units-i", "Imperial" %>

		<%= radio_button_tag 'units', 'm', @user.preferences["units"] == "m" ? true : false, :id => "units-m" %>
		<%= label_tag "units-m", "Metric" %>
	</div>

	<%= button_tag(type: 'submit', class: 'btn') do %>
		Save
	<% end %>
<% end %>

</div>